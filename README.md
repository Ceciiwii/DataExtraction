# Data Extract

This project contains scripts for data extraction from oxycontroller.

## Virtual Environment Setup

To run the scripts in this project, it is recommended to set up a Python virtual environment. Follow these steps to set up the virtual environment:

1. Navigate to the repository directory:

    `cd data_extract`

2. Create a virtual environment using `virtualenv`:

* Install `python3-venv` with: 

    `sudo apt install python3-venv`

* Create the virtual enviroment with: 
  
    `python3 -m venv .venv`

3. Activate the virtual environment. Depending on your operating system:
  
    `source .venv/bin/activate`

4. Install the project dependencies:

* Check  "*requirements.txt*" and execute:
  
    `pip install -r requirements.txt`
  
5. To compile and run the interface:

  * Locate yourself within the "*scripts*" folder and execute:
  
    `pyinstaller --onefile --windowed --add-data "recursos:recursos" dataextraction.py`

- Executing this command will create a *dataextracStion.spec*  file and two folders: *build* y *dist*.

- To use the executable file, enter *dist* and execute the file located there.

6. Once you are finished working with the project, you can deactivate the virtual environment:

    `deactivate`


# Instructions for Creating a Debian Package

This README provides a step-by-step guide for creating a Debian package (.deb) for the DataExtraction 2.0 project.

## Prerequisites:

* dpkg-deb: Used to build the Debian package.
* nano (or another text editor): For editing the package configuration files.


## Steps to Create the Debian Package

### 1.  Run the following command inside the scripts folder:
    ` pyinstaller --onefile --windowed --add-data "recursos:recursos" dataextraction.py`

    - Executing this command will create a *dataextraction.spec*  file and two folders: *build* y *`dist`*.


### 2.  Project Structure:
Create a folder with the name and version of the application:

    `mkdir dataextraction-2.0`

Then:

    `cd mkdir dataextraction-2.0`

    `mkdir DEBIAN`

    `mkdir -p usr/local/bin`

Ensure that your project has the following directory structure:

    dataextraction-2.0/
    ├── DEBIAN/
    └── usr/
        └── local/
            └── bin/

### 3.  Using the created executable:
We look for the executable that was created inside the dist folder in step 1 and place it inside the folder "`bin`":

`cd usr/local/bin`

### 4.  Package Configuration
Within the DEBIAN directory, edit the following files as needed:

`cd DEBIAN`

* control: Define package details such as name, version, description, and dependencies.

* copyright: Specify software copyright and license.

* changelog: Record package changes and versions.

For example: 

`nano control`
    
        Package: DataExtraction
        Version: 2.0
        Architecture: all
        Maintainer: Name name@innovex.cl>
        Description: Automatically download data


### 5.  File Permissions:
* Verify that files and directories have correct permissions.

`sudo chown -R root:root /home/directory/of/dataextraction-2.0`

### 6. Building the Package
* To create the Debian package:

`sudo dpkg-deb --build /home/directory/of/dataextraction-2.0`

### 7. Package Installation:
* Check the directory where your data folder is located dataextraction-2.0. For example:

        deb
        └── dataextraction-2.0/
        │    ├── DEBIAN/
        │     ├── usr/
        │       └── local/
        │           └── bin/
        └── dataextraction-2.0.deb

* After building the package, you can install it using

    `sudo apt-get install /path/to/package.deb`


### 8. Testing

Perform tests to ensure the package installs correctly and functions as expected.

`dataextraction`
 
 * Press Ok button
 * Press Check Status button or Data Extraction button
 * Finally, press Sleep button (do not skip this step).

_Note: If you want to test the package. The files generated by the interface will be saved in the directory where you named the package_

## Troubleshooting Qt on Linux

If you experience errors related to loading Qt plugins, install the following libraries:
*   `sudo apt update`
*   `sudo apt install libxcb-keysyms1 libxcb-util1`
*   `sudo apt install libxcb1-dev xcb-proto libx11-dev libpthread-stubs0-dev libxau-dev libxdmcp-dev`


# Creating Windows Executables and Installer in Linux

This document outlines the steps to configure Wine, install Python and Inno Setup on a Linux environment, and then use these tools to create a Windows executable (.exe) and an installer for a Python application.

## Initial Wine Configuration

Before installing any Windows software on Linux, you need to prepare Wine:

`sudo apt update`

`sudo apt install wine`

`sudo apt-get install wine64` 

`wine --version`

# Configure Wine

`winecfg`

### _Press option Windows 10_

## 1. Installation of Windows Python

Download the Python installer from the official Python website:

https://www.python.org/downloads/windows/

Example for version 3.9.10:

https://www.python.org/ftp/python/3.9.10/python-3.9.10-amd64.exe

* Create a new directory for python.exe. Open a terminal in the directory where you downloaded the Python installer and execute it with Wine:

`wine python-3.9.10-amd64.exe` or `wine msiexec /i python-3.9.10-amd64.msi`

Follow the installer's prompts, making sure to select the option to add Python to the PATH.

## Create the .exe Executable

Navigate to the directory of your Python script and execute PyInstaller:

`pyinstaller --onefile --windowed --add-data "resources;resources" --icon=icon.ico dataextraction.py`

Note: The icon can be of your choice in .ico format. You can use this file converter: https://convertio.co/es/png-ico/


## Create a program installer...

### Installation of Inno Setup

Download Inno Setup from the official site:

https://jrsoftware.org/isdl.php

Example for version 6.2.1:

https://files.jrsoftware.org/is/6/innosetup-6.2.1.exe

## Install Inno Setup

Run the downloaded installer with Wine:

`wine innosetup-6.2.1.exe` or `WINEPREFIX=~/wine_inno_setup wine innosetup-6.2.1.exe`


Follow the installer instructions to complete the installation of Inno Setup.

You can now use Inno Setup to create an installer for your Windows executable application.
Tutorial: https://www.youtube.com/watch?v=vj15kfON9E4

* Select some options and answer some blocks of information and continue.
* In some Inno will ask where the executable is located. You must go to the `dist` folder (created previously) and select the .exe file inside.